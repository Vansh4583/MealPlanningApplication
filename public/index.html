
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <!-- This meta tag ensures that the website renders correctly across different device sizes, enhancing mobile responsiveness. -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Link to the external CSS stylesheet. Uncomment if you wish to customize or add styling. -->
    <!-- <link rel="stylesheet" href="styles.css">   -->

    <title>Database Application</title>
</head>

<body>
    <div class="tab-container">
        <button class="tab-btn" onclick="showTab('q1')">Query 1</button>
        <button class="tab-btn" onclick="showTab('q2')">Query 2</button>
        <button class="tab-btn" onclick="showTab('q3')">Query 3</button>
        <button class="tab-btn" onclick="showTab('q4')">Query 4</button>
        <button class="tab-btn" onclick="showTab('q5')">Query 5</button>
        <button class="tab-btn" onclick="showTab('q6')">Query 6</button>
        <button class="tab-btn" onclick="showTab('q7')">Query 7</button>
        <button class="tab-btn" onclick="showTab('q8')">Query 8</button>
        <button class="tab-btn" onclick="showTab('q9')">Query 9</button>
        <button class="tab-btn" onclick="showTab('q10')">Query 10</button>
    </div>
    <hr>
    
    <h1>Meal Planning Application<h1>
    <!-- ===================================================================================== -->
    <!-- Display the current status of the database connection. 
         !!HERE TO HELP U DEBUGGING, NOT REQUIRED IN YOUR OWN PROJECT!!
         -->
    <h2>(Database Connection Status:
        <!-- An in-line placeholder to display connection status. -->
        <span id="dbStatus"> </span>
        <!-- A loading GIF, will be hided once get the status. -->
        <img id="loadingGif" class="loading-gif" src="loading_100px.gif" alt="Loading...">)
    </h2>

    <br>
    <hr><br> <!-- ========================================================================= -->

    <h2>Set up the database</h2>
    <button id="setupDatabase">Setup (Create + Populate)</button>
    <p id="setupDatabaseMsg"></p>

    <div id="q1" class="tab-content">
    <br>
    <hr><br> <!-- ========================================================================= -->
    <h2>Query 1: Insert</h2>
    <p>Insert a new follow relationship between a user and a meal plan.</p>
    <form id="insertFollowForm">
        User ID (FK to users table): <input type="number" id="followUsrId" required><br><br>
        Meal Plan ID (FK to mealplan table): <input type="number" id="followMid" required><br><br>
        Is Active (1 = yes, 0 = no): <input type="number" id="followIsActive" min="0" max="1" required><br><br>
        <button type="submit">Insert Follow</button>
    </form>
    <div id="insertFollowResult"></div>

    <table id="followTable" border="1" style="margin-top: 20px; display:none;">
        <thead>
            <tr>
                <th>User ID</th>
                <th>MealPlan ID</th>
                <th>IsActive</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    </div>

    <div id="q2" class="tab-content">
    <br>
    <hr><br> <!-- ========================================================================= -->
    <h2>Query 2: Update</h2>
    <p>Select a recipe and optionally update its name, difficulty, and/or creator user ID.</p>

    <label for="recipeSelect">Select Recipe:</label>
    <select id="recipeSelect"></select><br><br>

    <form id="updateRecipeForm">
        New Name (non-PK, also FK to dishServingTemperatures table):<br>
        <input type="text" id="updateRecipeName" placeholder="Leave blank to stay same"><br><br>

        New Difficulty (non-PK):<br>
        <input type="text" id="updateRecipeDifficulty" placeholder="Leave blank to stay same"><br><br>

        New User ID (non-PK, also FK to users table):<br>
        <input type="number" id="updateRecipeUsrId" placeholder="Leave blank to stay same"><br><br>

        <button type="submit">Update Recipe</button>
    </form>
    <div id="updateRecipeResult"></div>

</div>

    <div id="q3" class="tab-content">
    <br>
    <hr><br> <!-- ========================================================================= -->
    <h2>Query 3: Delete</h2>
    <p>Delete a meal plan. Related rows in follow table will be removed via ON DELETE CASCADE.</p>
    Meal Plan ID: <input type="number" id="deleteMealPlanId">
    <button id="deleteMealPlanBtn">Delete Meal Plan</button>
    <div id="deleteMealPlanResult"></div>

    <h3>Current Meal Plans</h3>
<table id="mealPlanTable" border="1" style="margin-top: 10px; display: none;">
    <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Meals per Week</th>
            <th>Date Created</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>
</div>

<div id="q4" class="tab-content">
<br><hr><br> <!-- ========================================================================= -->

<h2>Query 4: Search Recipes</h2>
<p>Search for recipes using multiple criteria with AND/OR logic.</p>
<form id="searchRecipesForm">
    <label>Difficulty:</label>
    <select id="searchDifficulty">
        <option value="">Any</option>
        <option value="Easy">Easy</option>
        <option value="Medium">Medium</option>
        <option value="Hard">Hard</option>
    </select>
    
    <!-- first AND/OR-->
    <select id="searchLogic">
        <option value="AND">AND</option>
        <option value="OR">OR</option>
    </select>
    
    <label>Serving Temperature:</label>
    <select id="searchServingTemp">
        <option value="">Any</option>
        <option value="Hot">Hot</option>
        <option value="Cold">Cold</option>
    </select>

    <!-- second AND/OR-->
    <select id="searchLogic2">
        <option value="AND">AND</option>
        <option value="OR">OR</option>
    </select>

    <label>User ID:</label>
    <select id="UserID">
        <option value="">Any User</option>
    </select>
    
    <button type="submit">Search Recipes</button>
</form>
<div id="searchRecipesResultMsg"></div>
<table id="searchRecipesTable" border="1" style="margin-top: 20px; display: none;">
    <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Difficulty</th>
            <th>Serving Temperature</th>
            <th>UserID</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>
</div>

<div id="q5" class="tab-content">

<br><hr><br> <!-- ========================================================================= -->

<h2>Query 5: View User Information (Projection)</h2>
<p>Select which columns you want to view from the Users table.</p>
<form id="projectionForm">
    <label>Select columns to display:</label><br>
    <label><input type="checkbox" name="projCol" value="id" checked> ID</label>
    <label><input type="checkbox" name="projCol" value="name" checked> Name</label>
    <label><input type="checkbox" name="projCol" value="height"> Height</label>
    <label><input type="checkbox" name="projCol" value="weight"> Weight</label>
    <br><br>
    <button type="submit">View Users</button>
</form>
<div id="projectionResultMsg"></div>
<table id="projectionTable" border="1" style="margin-top: 20px; display: none;">
    <thead id="projectionTableHead"></thead>
    <tbody id="projectionTableBody"></tbody>
</table>
</div>

<div id="q6" class="tab-content">
<br><hr><br> <!-- ========================================================================= -->

<h2>Query 6: Find Recipes by Ingredient (Join)</h2>
<p>Select an ingredient to see all recipes that use it.</p>
<form id="joinRecipesForm">
    <label>Select Ingredient:</label>
    <select id="ingredientDropdown" required>
        <option value="">-- Select an ingredient --</option>
    </select>
    <button type="submit">Find Recipes</button>
</form>
<div id="joinRecipesResultMsg"></div>
<table id="joinRecipesTable" border="1" style="margin-top: 20px; display: none;">
    <thead>
        <tr>
            <th>Recipe ID</th>
            <th>Recipe Name</th>
            <th>Difficulty</th>
            <th>Amount</th>
            <th>Unit</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

</div>

<div id="q7" class="tab-content">
    <br>
    <hr><br> <!-- ========================================================================= -->
    <h2>Query 7: Aggregation</h2>
    <p> Click the button to find the time it takes to make each recipe <br>
        <button id="sumRecipeTimes"> Fetch </button> <br>
        <!-- Div to hold the message -->
    <div id="sumRecipeTimeResultMsg"></div> <br>

    <h2>Recipe Completion Times</h2>
    <table id="sumRecipeTimesTable" border="1">
        <thead>
            <tr>
                <th>Recipe Id</th>
                <th>Name </th>
                <th>Time To Complete</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</p>
</div>
<div id="q8" class="tab-content">
    <hr><br> <!-- ========================================================================= -->
    <h2>Query 8: Aggregation with Having</h2>
    <p> Use this to find recipes that use at most the inputted number of ingredients </p>
    <form id="recipeIngredientCountFilter">
        Max # of Ingredients: <input type="number" id="maxRecipeIngredientCount" step="1" min="1"
            placeholder="Enter the max # of ingredients">
        <button type="submit"> Find </button>

    </form>
    <h2> Matching Recipes </h2>
    <table id="recipeIngredientCountTable" border="1">
        <thead>
            <tr>
                <th>Recipe Id</th>
                <th>Name</th>
                <th>Number of Ingredients</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>
<div id="q9" class="tab-content">
    <hr><br> <!-- ========================================================================= -->
    <h2>Query 9: Nested Aggregation with Group By </h2>
    <p> Click the button to find meal plans that use less recipes than average<br>
        <button id="belowAverageRecipeCountMealPlans"> Fetch </button> <br>

    <h2>Recipe Completion Times</h2>
    <table id="belowAverageRecipeCountMealPlansTable" border="1">
        <thead>
            <tr>
                <th>Mealplan Id</th>
                <th>Name </th>
                <th>Number of Recipes</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
    </p>
</div>
<div id="q10" class="tab-content">
    <hr><br> <!-- ========================================================================= -->
    <h2>Query 10: Division</h2>
    <p>Find users who are actively following <strong>all</strong> meal plans.</p>
    <button id="divisionBtn">Run Division Query</button>
    <br><br>
    <table id="divisionTable" border="1">
        <thead>
            <tr>
                <th>User ID</th>
                <th>Name</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <div id="divisionResultMsg"></div>
    <hr><br>
</div>

    <!-- External JavaScript file that contains the functionality/logic for the operations above. -->
    <script src="scripts.js"></script>
</body>

</html>
